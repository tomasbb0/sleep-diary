<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Import Sleep Data</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f5f0e6;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }
        .container {
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        h1 { color: #6b5b47; margin-bottom: 1rem; font-size: 1.5rem; }
        p { color: #666; margin-bottom: 1.5rem; font-size: 0.9rem; }
        button {
            width: 100%;
            padding: 1rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 1rem;
            cursor: pointer;
            margin-bottom: 0.75rem;
        }
        #login { background: #4285f4; color: white; }
        #import { background: #6b5b47; color: white; }
        #import:disabled { background: #ccc; cursor: not-allowed; }
        #logout { background: #dc3545; color: white; display: none; }
        #log {
            background: #f5f5f5;
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: monospace;
            font-size: 0.85rem;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 1rem;
        }
        .user-info {
            background: #e8f5e9;
            padding: 0.75rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            display: none;
        }
        a { color: #6b5b47; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåô Importar Dados do Di√°rio</h1>
        <p>Esta p√°gina importa os dados do teu di√°rio em papel (7-13 Janeiro 2026) para a app.</p>
        
        <div class="user-info" id="user-info"></div>
        
        <button id="login">üîê Login com Google</button>
        <button id="import" disabled>üì• Importar Dados (7 dias)</button>
        <button id="logout">üö™ Logout</button>
        
        <pre id="log">Clica em "Login com Google" para come√ßar...</pre>
        
        <p style="margin-top: 1.5rem; text-align: center;">
            <a href="index.html">‚Üê Voltar para a app</a>
        </p>
    </div>
    
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyB2S_kUQmNBcSDX19nC3LN2G7trPnBqNGw",
            authDomain: "sleep-diary-5b72f.firebaseapp.com",
            projectId: "sleep-diary-5b72f",
            storageBucket: "sleep-diary-5b72f.firebasestorage.app",
            messagingSenderId: "358310065752",
            appId: "1:358310065752:web:0f3a5d5870dfe91a34fc2d"
        };
        
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // Data from paper diary (7-13 Jan 2026)
        const sleepData = {
            "2026-01-07": {
                acordou: "15:00", levantou: "15:30", como_sente_manha: "Mal",
                sestas: "N√£o", cafeina: "", atividade_fisica: "",
                deitou: "04:00", tempo_adormecer: "20", vezes_acordou: "0",
                sono_total: "4h 00min", comprimidos: "N√£o", alcool: "N√£o bebi",
                qualidade_noite: "Razoavelmente"
            },
            "2026-01-08": {
                acordou: "08:30", levantou: "08:40", como_sente_manha: "Mal",
                sestas: "N√£o", cafeina: "5 bicas", cafeina_ultima_hora: "11:00",
                atividade_fisica: "", deitou: "05:00", tempo_adormecer: "25",
                vezes_acordou: "0", despertares_oque: "Inalador p/ olhos + fui pedar",
                tempo_acordado_noite: "60", sono_total: "10h 00min",
                comprimidos: "N√£o", alcool: "N√£o bebi", qualidade_noite: "Razoavelmente"
            },
            "2026-01-09": {
                acordou: "15:00", levantou: "15:30", como_sente_manha: "Razoavelmente",
                sestas: "N√£o", cafeina: "1 bica", cafeina_ultima_hora: "14:00",
                atividade_fisica: "", deitou: "04:00", tempo_adormecer: "60",
                vezes_acordou: "1", despertares_oque: "Logo pq estava cheio para sono",
                tempo_acordado_noite: "60", sono_total: "12h 15min",
                comprimidos: "N√£o", alcool: "N√£o bebi", qualidade_noite: "Bem"
            },
            "2026-01-10": {
                acordou: "12:30", levantou: "13:15", como_sente_manha: "Razoavelmente",
                sestas: "Sim", sestas_duracao: "14h/15h (r√°pido) - 16:30",
                cafeina: "1 (amorim)", cafeina_ultima_hora: "15:00",
                atividade_fisica: "Caminhada", deitou: "05:00", tempo_adormecer: "60",
                vezes_acordou: "2", despertares_oque: "Estam cheio de sono",
                tempo_acordado_noite: "60", sono_total: "5h 00min",
                comprimidos: "N√£o", alcool: "3-4 bebidas",
                alcool_tipo: "Caipirinha + jarra + mari e bebi", qualidade_noite: "Bem"
            },
            "2026-01-11": {
                acordou: "06:45", levantou: "14:00", como_sente_manha: "Razoavelmente",
                sestas: "N√£o", cafeina: "1 bica", cafeina_ultima_hora: "15:00",
                atividade_fisica: "Bicicleta 10m (amadora/odivelas)",
                deitou: "05:30", tempo_adormecer: "5", vezes_acordou: "2",
                despertares_oque: "Logo p/ me levar", tempo_acordado_noite: "80",
                sono_total: "10h 45min", comprimidos: "N√£o", alcool: "3-4 bebidas",
                alcool_tipo: "Frita + jarra Lx", qualidade_noite: "Bem"
            },
            "2026-01-12": {
                acordou: "15:00", levantou: "15:30", como_sente_manha: "Mal",
                sestas: "N√£o", cafeina: "1 bica", cafeina_ultima_hora: "15:00",
                atividade_fisica: "Univ s/carro + 10 passos - caminhar",
                deitou: "01:00", tempo_adormecer: "30", vezes_acordou: "3",
                despertares_oque: "24:30 depois - adormecei em 3min",
                tempo_acordado_noite: "30", sono_total: "5h 30min",
                comprimidos: "N√£o", alcool: "N√£o bebi", qualidade_noite: "Muito bem"
            },
            "2026-01-13": {
                acordou: "14:30", levantou: "15:00", como_sente_manha: "Razoavelmente",
                sestas: "N√£o", cafeina: "", atividade_fisica: "",
                deitou: "03:30", tempo_adormecer: "30", vezes_acordou: "3",
                tempo_acordado_noite: "150", sono_total: "11h 00min",
                comprimidos: "N√£o", alcool: "N√£o bebi", qualidade_noite: "Muito bem"
            }
        };
        
        // Auth state listener
        auth.onAuthStateChanged((user) => {
            if (user) {
                document.getElementById('login').style.display = 'none';
                document.getElementById('logout').style.display = 'block';
                document.getElementById('import').disabled = false;
                document.getElementById('user-info').style.display = 'block';
                document.getElementById('user-info').textContent = '‚úÖ Logged in: ' + user.email;
                document.getElementById('log').textContent = 'Pronto para importar! Clica em "Importar Dados"';
            } else {
                document.getElementById('login').style.display = 'block';
                document.getElementById('logout').style.display = 'none';
                document.getElementById('import').disabled = true;
                document.getElementById('user-info').style.display = 'none';
                document.getElementById('log').textContent = 'Clica em "Login com Google" para come√ßar...';
            }
        });
        
        document.getElementById('login').onclick = async () => {
            try {
                document.getElementById('log').textContent = 'A abrir popup de login...';
                const provider = new firebase.auth.GoogleAuthProvider();
                await auth.signInWithPopup(provider);
            } catch (e) {
                document.getElementById('log').textContent = '‚ùå Erro: ' + e.message;
            }
        };
        
        document.getElementById('logout').onclick = async () => {
            await auth.signOut();
        };
        
        document.getElementById('import').onclick = async () => {
            const log = document.getElementById('log');
            log.textContent = 'A importar dados...\n';
            
            try {
                for (const [date, answers] of Object.entries(sleepData)) {
                    await db.collection('users').doc(auth.currentUser.uid)
                        .collection('entries').doc(date).set({
                            date: date,
                            answers: answers,
                            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                        });
                    log.textContent += `‚úÖ ${date} importado\n`;
                }
                log.textContent += '\nüéâ Todos os dados importados com sucesso!\n\nPodes ir para a app e ver no Hist√≥rico.';
            } catch (e) {
                log.textContent += '\n‚ùå Erro: ' + e.message;
            }
        };
    </script>
</body>
</html>
