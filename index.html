<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#f0f4ff">
    <title>Di√°rio de Sono</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Auth Screen -->
    <div id="auth-screen" class="screen active">
        <div class="auth-container">
            <div class="auth-logo">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="white" stroke="none">
                    <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/>
                </svg>
            </div>
            <h1 class="auth-title">Di√°rio de Sono</h1>
            <p class="auth-subtitle">Registe o seu sono e melhore os seus h√°bitos</p>
            
            <button id="google-login" class="auth-btn">
                <svg width="18" height="18" viewBox="0 0 18 18">
                    <path fill="#4285F4" d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z"/>
                    <path fill="#34A853" d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332A8.997 8.997 0 0 0 9 18z"/>
                    <path fill="#FBBC05" d="M3.964 10.71A5.41 5.41 0 0 1 3.682 9c0-.593.102-1.17.282-1.71V4.958H.957A8.996 8.996 0 0 0 0 9c0 1.452.348 2.827.957 4.042l3.007-2.332z"/>
                    <path fill="#EA4335" d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0A8.997 8.997 0 0 0 .957 4.958L3.964 7.29C4.672 5.163 6.656 3.58 9 3.58z"/>
                </svg>
                Continuar com Google
            </button>
            
            <button id="apple-login" class="auth-btn">
                <svg width="18" height="18" viewBox="0 0 18 18" fill="currentColor">
                    <path d="M14.94 9.88c-.02-2.07 1.69-3.06 1.77-3.11-.96-1.41-2.46-1.6-3-1.63-1.27-.13-2.49.75-3.14.75-.65 0-1.65-.73-2.72-.71-1.4.02-2.69.81-3.41 2.07-1.46 2.53-.37 6.27 1.04 8.32.7 1.01 1.53 2.14 2.62 2.1 1.05-.04 1.45-.68 2.72-.68 1.27 0 1.63.68 2.73.66 1.13-.02 1.84-1.02 2.52-2.03.8-1.17 1.13-2.3 1.14-2.36-.02-.01-2.19-.84-2.22-3.33l-.05-.05zM12.85 3.42c.57-.7.96-1.66.85-2.62-.82.03-1.82.55-2.41 1.24-.53.61-1 1.53-.87 2.46.92.07 1.86-.46 2.43-1.08z"/>
                </svg>
                Continuar com Apple
            </button>
            
            <div class="auth-divider">ou</div>
            
            <div class="auth-form">
                <input type="email" id="email" placeholder="Email" autocomplete="email">
                <input type="password" id="password" placeholder="Password" autocomplete="current-password">
                <div class="auth-buttons">
                    <button id="email-login">Entrar</button>
                    <button id="email-signup">Registar</button>
                </div>
            </div>
            
            <div id="auth-error"></div>
        </div>
    </div>

    <!-- App Screen -->
    <div id="app-screen" class="screen">
        <header class="app-header">
            <h1>Di√°rio de Sono</h1>
            <button id="logout">Sair</button>
        </header>
        
        <nav class="tabs">
            <button class="tab active" data-tab="new-session">Nova Sess√£o</button>
            <button class="tab" data-tab="history">Hist√≥rico</button>
        </nav>
        
        <!-- New Session Tab -->
        <div id="new-session-tab" class="tab-content active">
            <div id="session-available" class="session-box">
                <div class="session-icon">
                    <svg width="44" height="44" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="4"/>
                        <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/>
                    </svg>
                </div>
                <h2>Bom Dia!</h2>
                <p class="session-subtitle">Registe como dormiu esta noite</p>
                <button id="start-session" class="btn-primary">Come√ßar Registo</button>
            </div>
            
            <div id="session-locked" class="session-box hidden">
                <div class="session-icon">
                    <svg width="44" height="44" viewBox="0 0 24 24" fill="white" stroke="none">
                        <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/>
                    </svg>
                </div>
                <h2>Registo Completo!</h2>
                <p class="session-subtitle">Pr√≥ximo registo dispon√≠vel em:</p>
                <div id="countdown" class="countdown">--:--:--</div>
                <p class="countdown-note">Dispon√≠vel √†s 04:30</p>
            </div>
            
            <div id="session-form" class="hidden">
                <div class="form-header">
                    <button id="cancel-session" class="btn-text">‚Üê Cancelar</button>
                    <span id="form-date">Noite de 12 Jan</span>
                </div>
                <div id="questions-container"></div>
                <div id="question-nav" class="question-nav">
                    <button id="prev-question">‚Üê Anterior</button>
                    <span id="question-progress">1 / 15</span>
                    <button id="next-question">Pr√≥xima ‚Üí</button>
                </div>
            </div>
        </div>
        
        <!-- History Tab -->
        <div id="history-tab" class="tab-content">
            <div class="history-header">
                <h2>Entradas</h2>
                <button id="add-past-entry" class="btn-small">+ Adicionar</button>
            </div>
            
            <div id="history-list"></div>
            
            <div id="history-edit-mode" class="hidden">
                <div class="form-header">
                    <button id="cancel-edit" class="btn-text">‚Üê Voltar</button>
                    <span id="edit-date">Editar: 12 Jan</span>
                    <button id="save-edit" class="btn-small btn-save">Guardar</button>
                </div>
                <div id="edit-questions-container"></div>
                <div id="edit-question-nav" class="question-nav">
                    <button id="edit-prev-question">‚Üê Anterior</button>
                    <span id="edit-question-progress">1 / 15</span>
                    <button id="edit-next-question">Pr√≥xima ‚Üí</button>
                </div>
            </div>
            
            <div id="add-past-modal" class="modal hidden">
                <div class="modal-content">
                    <h3>Adicionar Entrada Passada</h3>
                    <p>Selecione a noite que quer registar:</p>
                    <input type="date" id="past-date-picker">
                    <div class="modal-buttons">
                        <button id="cancel-add-past" class="btn-secondary">Cancelar</button>
                        <button id="confirm-add-past" class="btn-primary">Continuar</button>
                    </div>
                    <p id="add-past-error" class="error-text"></p>
                </div>
            </div>
            
            <button id="export-data" class="btn-export">üì• Exportar CSV</button>
        </div>
    </div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    
    <script src="config.js"></script>
    <script src="questions.js"></script>
    <script src="app.js"></script>
</body>
</html>
